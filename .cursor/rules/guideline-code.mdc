---
description: コーディングガイドライン。参照条件： コード・実装(*.go)を作成・編集する
globs:
alwaysApply: false
---


# コーディングガイドライン

* コメントは日本語で記述する
* コードを書く際は同一レイヤの類似のファイルを参考にすること
* パブリック関数はモジュール毎に１つが望ましい
  * 他のモジュールから呼び出さない関数はプライベート関数とする
* 構造体の受け渡しは特別な理由が無い限り値渡しとする
* コードを書く際は各レイヤの類似のファイルを参考にすること
* 数値型には精度を明示すること
* entを用いたDBアクセスは副作用であるが、例外的にapplication/handlerに記述してよい
    * 但し、DBアクセス部分は関数に切り出すこと（１つのSQL文に対して１つの関数を定義する）
    * 理由： テストコードを書く際に、DBアクセスをモック化しないため
* 指示と関係のないリファクタリングはしないでください

# バリデーション

* 項目毎のシンプルなバリデーションはswagger.ymlに記述されており、go-swaggerによって自動的に生成されるためhandlerで実装する必要はありません。
    * 例：文字列の長さ、数値の範囲、必須項目のチェックなど
* 以下のような複雑なバリデーションは、application/handler内のAPIハンドラーで行います。
    * 複数のフィールドを組み合わせてのバリデーション
    * DBの状態に依存するバリデーション

# エラーハンドリング

* 基本的には発生したerrorをeris.Wrapして返すだけで良いです
* eris.Wrapの第二引数は空文字で良いです